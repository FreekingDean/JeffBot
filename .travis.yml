language: ruby
cache: bundler
rvm:
  - 2.3.0
git:
  submodules: false
env:
  global:
    - RACK_ENV=test
services:
  - postgresql
  - rabbitmq
notifications:
  email:
    recipients:
      - deangalvin3@gmail.com
    on_success: change
    on_failure: always
branches:
  only:
    - master
install:
  - bundle install
before_script:
  - psql -c 'create database travis_ci_test;' -U postgres
  - cp db/config.travis.yml db/config.yml
script:
  - RAILS_ENV=test bundle exec rake db:create --trace
  - RAILS_ENV=test bundle exec rake db:migrate --trace
  - bundle exec rake db:test:prepare
  - bundle exec rspec --color -p
  - bundle exec rubocop
deploy:
  provider: heroku
  on:
    branch: master
  app: jeffbot-public
  api_key:
    secure: BbGi1r3CwvkZXaQK36RSy84L0fn0VufBaj2SLlplgTnxXvLeCH7xhD2XcEOt+n4OaY4Ok6O9Fi9ZYbNCE+tyPNYz5gZBJ52AaGwXA4IBs08y6dRv/wDQhooTHfPIHxjfRLz+YeAY0wEM7vtCZaRvLOA6AMCK3dLFxzScj8t+uLGqD+n8lIzSYjWA6d+aSjo0VE5Tj9Nu20Fv91LyCzJENUWWUmxNrm4tjOV8pPtfwr0FL3S2Ng4U23r0y1qWbBgTV7ir2GBQph94uskfBjfOYxk2qjlIN9SgCyaLc96nvoU5aGPCQoYMEDrRVj26ZsZ7iuZHLVO7Egb7Yqg2i9n5FNmKuS7iqTjxPmlCdKpFA1GaRhYzfm86X9Zr1zZ32/92JrSPLT8zqE1eyA6SSRhwsp5ajXTu722A5ODqqdCkJHnlPtU/Ax/bTEa2oAd07MStCEua2bl67CwMhQacekYy7fIX/ym0y9CElHFhzpsBvx6hJY+5BwcvfaksbwbZ0W5Lphm4OkZUwEhCagSZsPTO3Lakf10wmYM2ZNGVVM7yR8PejLmAiwuYUYW8gNeREdPW0IuH6b77afivGBKmfy2jxe0A80NT5VoDIjXs8MdfnSEfpJpED5OwiIUiXEeJp/MXA+NSplhijmzDKcut/ZHVcnQm4a5lS7wWyyKRl/DmCGU=
