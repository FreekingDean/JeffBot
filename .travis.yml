language: ruby
cache: bundler
rvm:
  - 2.3.0
git:
  submodules: false
env:
  global:
    - RACK_ENV=test
services:
  - postgresql
  - rabbitmq
notifications:
  email:
    recipients:
      - deangalvin3@gmail.com
    on_success: change
    on_failure: always
branches:
  only:
    - master
install:
  - bundle install
before_script:
  - psql -c 'create database travis_ci_test;' -U postgres
  - cp db/config.travis.yml db/config.yml
script:
  - RAILS_ENV=test bundle exec rake db:create --trace
  - RAILS_ENV=test bundle exec rake db:migrate --trace
  - bundle exec rake db:test:prepare
  - bundle exec rspec --color -p
  - bundle exec rubocop
deploy:
  provider: heroku
  on:
    branch: master
  app: jeffbot-public
  api_key:
    secure: GE9KQHMqg51PZFedFMCrfT7qFG0oi3qbEIUZaEbKVAw3OgrUAIHOPSl0RteVPFyKZ99f6yWjFs6EG0VflNiu9DoJfZAUJlPZVU4XkTGFFCPFN8dB3egl2SoZaWv4JetG0k0MKLSgPmzZn/J1A3CVgbcq01kVg6SknvqpZ6Di+OMW9Pmnigvb6wQJFylasjrdfjadP2dsb6yhg/E2s36NJdjFuBMR4bqSNME8AylFraHhTIoWOsDxm7is7dXx86QEmjI18MProI2Fll3cWBNmKIivycGxT8M6nKDMHwGym7Jm93e2vMz9gzYsTdUBXP1uOGH4cBnxplvMf5SIRuq8WdBXbTu8OgGl66EUJ9ImMueIW18mAzlo1b83sBDmLHm8wCPD+8z0pM+89K6prHp8DsAuy77l/kki31j4O2eX6iGCs4sd/EgRvXayO8cs1MbFkmOfGEf7eF80b3jseqt/36K6/rb2Fe6OodLsEbFFHeIgiyYjKpuOcyg1oHYmMJgde6xahn3y+lS/qYee9T/Jj9g7MuzXKPpdv8yeePkRVv5asj+E9KuaX8vlrrgx2hMi15gtd7jUkOBO3dz43x190T5ZVAIQZq1RuhypE3RsMhC8R0G3b7z493AmlH4cNfGWOlY6z/I57XwZwqEWprnG9XpTigIrYDHFAwPIALsF1sg=
